<?xml version="1.0" encoding="utf-8" ?> 

<project name="NDbUnit.Test" default="build">
	<!-- Required properties:
			build.debug - (true|false) debug build?
			build.dir - (path) root level to build to
			build.config - (debug|release) assemblies will go in$ {build.dir}\bin\${build.config}\
	-->
		
	<property name="project.localpath" value="${nant.project.basedir}" />
	<property name="MbUnit.dir" value="C:\Program Files\MbUnit 2.2\bin" />
	<property name="MbUnit.fw.dll" value="${MbUnit.dir}\MbUnit.framework.dll" />

	<ifnot test='${file::exists(MbUnit.fw.dll)}'>
	  <fail message="MbUnit has not been installed in the location identified in the MbUnit.dir property." />
	</ifnot>

	<target name="build">
		<echo message="Using '${nant.settings.currentframework}' Framework"/>

		<!-- Build NDbUnit.Test -->
		<csc target="library" debug="${build.debug}" output="${build.dir}\bin\${build.config}\${nant.project.name}.dll">
			<sources failonempty="true">
				<include name="${project.localpath}/**/*.cs" />
			</sources>
			<references>
				<include name="${build.dir}\bin\${build.config}\NDbUnit.Core.dll" />
				<include name="${MbUnit.dir}\MbUnit.framework.dll" />				
			</references>
		</csc>
		
		<copy todir="${build.dir}\Xml">
			<fileset basedir="${project.localpath}\Xml">
				<include name="**/*"/>
			</fileset>
		</copy>
	</target>

	<target name="clean">
		<delete dir="bin" failonerror="false"/>
		<delete dir="obj" failonerror="false"/>
	</target>
</project>

